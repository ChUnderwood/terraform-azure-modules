import "tfplan/v2" as tfplan

prohibited_res = [
    "azurerm_resource_group",
    "azurerm_virtual_network",
    "azurerm_network_security_group",
    "azurerm_subnet_network_security_group_association",
]

main = rule {
    all filter tfplan.resource_changes as _, res {
        res.type in prohibited_res
    } as _, res {
        res.module_address is ""
    }
}
